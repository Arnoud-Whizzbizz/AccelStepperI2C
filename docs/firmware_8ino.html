<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AccelStepperI2C: firmware.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AccelStepperI2C
   &#160;<span id="projectnumber">v 0.1</span>
   </div>
   <div id="projectbrief">I2C wrapper (and a bit more) for the AccelStepper Arduino library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('firmware_8ino.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">firmware.ino File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Firmware for an I2C slave controlling up to 8 stepper motors via AccelStepper library.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Firmware for an I2C slave controlling up to 8 stepper motors via AccelStepper library. </p>
<p>This documentation is probably only relevant for you if you want to change the firmware. Otherwise, the library documentation should suffice. </p>
<h1><a class="anchor" id="author"></a>
Author</h1>
<p>Copyright (c) 2022 juh </p>
<h1><a class="anchor" id="license"></a>
License</h1>
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, version 2. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd><p class="startdd">debugging </p>
<p class="interdd">return messages (results) should ideally come with an id, too, so that master can be sure it's the correct result. Currently only msg. length is checked. </p>
<p class="interdd">volatile variables??? </p>
<p class="interdd"><del>make i2c address configurable with pins or via i2c/EEPROM</del> </p>
<p class="enddd"><del>implement endstops/reference positions</del> </p>
</dd></dl>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_endstop.html">Endstop</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_stepper.html">Stepper</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">holds stepper parameters needed for local slave management  <a href="struct_stepper.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae19f7f44c494f571f8860c91f2fdba22"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#ae19f7f44c494f571f8860c91f2fdba22">DIAGNOSTICS_AccelStepperI2C</a></td></tr>
<tr class="separator:ae19f7f44c494f571f8860c91f2fdba22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66726e5f1a55e7253ddd5aeec06f19c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a66726e5f1a55e7253ddd5aeec06f19c3">log</a>(...)</td></tr>
<tr class="separator:a66726e5f1a55e7253ddd5aeec06f19c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cad4e2514f451585f15da3b8ee3cd2f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a1cad4e2514f451585f15da3b8ee3cd2f">EEPROM_OFFSET_I2C_ADDRESS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a1cad4e2514f451585f15da3b8ee3cd2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9d641c48e9eaae758eb0ea69cdbfa9c7"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a9d641c48e9eaae758eb0ea69cdbfa9c7">retrieveI2C_address</a> ()</td></tr>
<tr class="memdesc:a9d641c48e9eaae758eb0ea69cdbfa9c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a stored I2C address from EEPROM. If there is none, use default.  <a href="firmware_8ino.html#a9d641c48e9eaae758eb0ea69cdbfa9c7">More...</a><br /></td></tr>
<tr class="separator:a9d641c48e9eaae758eb0ea69cdbfa9c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04dab60aa1102ee6bfabfc6a039849ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a04dab60aa1102ee6bfabfc6a039849ee">storeI2C_address</a> (uint8_t newAddress)</td></tr>
<tr class="memdesc:a04dab60aa1102ee6bfabfc6a039849ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write I2C address to EEPROM.  <a href="firmware_8ino.html#a04dab60aa1102ee6bfabfc6a039849ee">More...</a><br /></td></tr>
<tr class="separator:a04dab60aa1102ee6bfabfc6a039849ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">setup system  <a href="firmware_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">More...</a><br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a8610cdcfb2697510a8ee83499558e"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#ae2a8610cdcfb2697510a8ee83499558e">addStepper</a> (uint8_t interface=AccelStepper::FULL4WIRE, uint8_t pin1=2, uint8_t pin2=3, uint8_t pin3=4, uint8_t pin4=5, bool enable=true)</td></tr>
<tr class="memdesc:ae2a8610cdcfb2697510a8ee83499558e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign and initialize new stepper. Calls the <a href="https://www.airspayce.com/mikem/arduino/AccelStepper/classAccelStepper.html#a3bc75bd6571b98a6177838ca81ac39ab">AccelStepper's[1/2] constructor</a>  <a href="firmware_8ino.html#ae2a8610cdcfb2697510a8ee83499558e">More...</a><br /></td></tr>
<tr class="separator:ae2a8610cdcfb2697510a8ee83499558e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e3313868c67fbcdc7a267c53ad4339"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a99e3313868c67fbcdc7a267c53ad4339">readEndstops</a> (uint8_t s)</td></tr>
<tr class="separator:a99e3313868c67fbcdc7a267c53ad4339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50179c999500e0f9408006422deae52f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a50179c999500e0f9408006422deae52f">triggerInterrupt</a> (uint8_t source)</td></tr>
<tr class="separator:a50179c999500e0f9408006422deae52f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adebb2a389a701d95bb721df60053bf6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#adebb2a389a701d95bb721df60053bf6c">clearInterrupt</a> ()</td></tr>
<tr class="separator:adebb2a389a701d95bb721df60053bf6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop, implements the state machine. Will check for each stepper's state and do the appropriate polling (run() etc.) as needed. Also checks for incoming commands and passes them on for processing.  <a href="firmware_8ino.html#afe461d27b9c48d5921c00d521181f12f">More...</a><br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a52aa0319b0d3bea95eff4528baee98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a9a52aa0319b0d3bea95eff4528baee98">receiveEvent</a> (int howMany)</td></tr>
<tr class="memdesc:a9a52aa0319b0d3bea95eff4528baee98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle I2C receive event. Just read the message and inform main loop.  <a href="firmware_8ino.html#a9a52aa0319b0d3bea95eff4528baee98">More...</a><br /></td></tr>
<tr class="separator:a9a52aa0319b0d3bea95eff4528baee98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4906408a38ad9d4f1bca763aa75422ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a4906408a38ad9d4f1bca763aa75422ad">processMessage</a> (uint8_t len)</td></tr>
<tr class="memdesc:a4906408a38ad9d4f1bca763aa75422ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process message received via I2C. Normal messages consist of at least three bytes: [0] CRC8 checksum [1] Command. Most commands correspond to an AccelStepper function, some are new for I2C reasons (see I2C_commands.h). Unknown commands are ignored. [2] Number of the stepper that is to receive the command. If no stepper with this number exists, the message is ignored, except for general commands like resetCmd, which ignore this parameter. [3 - maxBuffer] Optional parameter bytes. Each command that comes with too many or too few parameter bytes is ignored.  <a href="firmware_8ino.html#a4906408a38ad9d4f1bca763aa75422ad">More...</a><br /></td></tr>
<tr class="separator:a4906408a38ad9d4f1bca763aa75422ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac10b80b8aaeaf66cecbf0bb5eff5ae33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#ac10b80b8aaeaf66cecbf0bb5eff5ae33">requestEvent</a> ()</td></tr>
<tr class="memdesc:ac10b80b8aaeaf66cecbf0bb5eff5ae33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle I2C request event. Will send results or information requested by the last command, as defined by the contents of the outputBuffer.  <a href="firmware_8ino.html#ac10b80b8aaeaf66cecbf0bb5eff5ae33">More...</a><br /></td></tr>
<tr class="separator:ac10b80b8aaeaf66cecbf0bb5eff5ae33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a31bf94b26fef450b158d5840aa419886"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a31bf94b26fef450b158d5840aa419886">diagnosticsEnabled</a> = false</td></tr>
<tr class="separator:a31bf94b26fef450b158d5840aa419886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0733c667851852a49c093ba87c7d77a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#ab0733c667851852a49c093ba87c7d77a">thenMicros</a></td></tr>
<tr class="separator:ab0733c667851852a49c093ba87c7d77a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e30077c912bea300765cce6e5348b2d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdiagnostics_report.html">diagnosticsReport</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a7e30077c912bea300765cce6e5348b2d">currentDiagnostics</a></td></tr>
<tr class="separator:a7e30077c912bea300765cce6e5348b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9405df89f8c78a1f50085b10911ca37"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#af9405df89f8c78a1f50085b10911ca37">cycles</a> = 0</td></tr>
<tr class="separator:af9405df89f8c78a1f50085b10911ca37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404cd08737b3728198d3e42c828ece79"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a404cd08737b3728198d3e42c828ece79">eepromI2CaddressMarker</a> = 0x12C0ACCF</td></tr>
<tr class="separator:a404cd08737b3728198d3e42c828ece79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15a5efb5c2c5ce3714d8a2f6c309033"><td class="memItemLeft" align="right" valign="top">const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#af15a5efb5c2c5ce3714d8a2f6c309033">I2C_defaultAddress</a> = 0x8</td></tr>
<tr class="separator:af15a5efb5c2c5ce3714d8a2f6c309033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eca28b463b5850006c7d00aa43a2498"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_simple_buffer.html">SimpleBuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a9eca28b463b5850006c7d00aa43a2498">bufferIn</a></td></tr>
<tr class="separator:a9eca28b463b5850006c7d00aa43a2498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d39df1bc00243ef2abb1ad3cc1acf8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_simple_buffer.html">SimpleBuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a4d39df1bc00243ef2abb1ad3cc1acf8e">bufferOut</a></td></tr>
<tr class="separator:a4d39df1bc00243ef2abb1ad3cc1acf8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd9824af02dde7126d00d43a74c0081"><td class="memItemLeft" align="right" valign="top">volatile uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#affd9824af02dde7126d00d43a74c0081">newMessage</a> = 0</td></tr>
<tr class="separator:affd9824af02dde7126d00d43a74c0081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89786b8678479bcf2338a522d43b9381"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a89786b8678479bcf2338a522d43b9381">interruptPin</a> = -1</td></tr>
<tr class="separator:a89786b8678479bcf2338a522d43b9381"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1764b48f3cc3657deeb69208ad55cb1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#ab1764b48f3cc3657deeb69208ad55cb1">interruptActiveHigh</a> = true</td></tr>
<tr class="separator:ab1764b48f3cc3657deeb69208ad55cb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa84ea5f47409c6c60bc911ba4bc06fb0"><td class="memItemLeft" align="right" valign="top">const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#aa84ea5f47409c6c60bc911ba4bc06fb0">maxEndstops</a> = 2</td></tr>
<tr class="separator:aa84ea5f47409c6c60bc911ba4bc06fb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b5902c36f57eccdc4e911f63edcd14b"><td class="memItemLeft" align="right" valign="top">const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a4b5902c36f57eccdc4e911f63edcd14b">maxSteppers</a> = 8</td></tr>
<tr class="separator:a4b5902c36f57eccdc4e911f63edcd14b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ffc376a015a72bacc0fa343e6fd7dd5"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a9ffc376a015a72bacc0fa343e6fd7dd5">numSteppers</a> = 0</td></tr>
<tr class="separator:a9ffc376a015a72bacc0fa343e6fd7dd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7658032e03469b7a54542145f6d59bc6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_stepper.html">Stepper</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#a7658032e03469b7a54542145f6d59bc6">steppers</a> [<a class="el" href="_speed__diagnostics_8ino.html#ab21cefe8676da0e84f405d867c7e0cac">maxSteppers</a>]</td></tr>
<tr class="separator:a7658032e03469b7a54542145f6d59bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af470ac2a95380c26878282f7ddf529de"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="firmware_8ino.html#af470ac2a95380c26878282f7ddf529de">resetFunc</a> )(void)=0</td></tr>
<tr class="separator:af470ac2a95380c26878282f7ddf529de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae19f7f44c494f571f8860c91f2fdba22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae19f7f44c494f571f8860c91f2fdba22">&#9670;&nbsp;</a></span>DIAGNOSTICS_AccelStepperI2C</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIAGNOSTICS_AccelStepperI2C</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1cad4e2514f451585f15da3b8ee3cd2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cad4e2514f451585f15da3b8ee3cd2f">&#9670;&nbsp;</a></span>EEPROM_OFFSET_I2C_ADDRESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EEPROM_OFFSET_I2C_ADDRESS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a66726e5f1a55e7253ddd5aeec06f19c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66726e5f1a55e7253ddd5aeec06f19c3">&#9670;&nbsp;</a></span>log</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define log</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae2a8610cdcfb2697510a8ee83499558e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2a8610cdcfb2697510a8ee83499558e">&#9670;&nbsp;</a></span>addStepper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t addStepper </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>interface</em> = <code>AccelStepper::FULL4WIRE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin1</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin2</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin3</em> = <code>4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin4</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign and initialize new stepper. Calls the <a href="https://www.airspayce.com/mikem/arduino/AccelStepper/classAccelStepper.html#a3bc75bd6571b98a6177838ca81ac39ab">AccelStepper's[1/2] constructor</a> </p>
<dl class="section return"><dt>Returns</dt><dd>number of stepper assigned to new stepper, -1 for error </dd></dl>
<dl class="section note"><dt>Note</dt><dd><a href="https://www.airspayce.com/mikem/arduino/AccelStepper/classAccelStepper.html#afa3061ce813303a8f2fa206ee8d012bd">AccelStepper()[2/2] constructor</a> currently unsupported </dd></dl>

</div>
</div>
<a id="adebb2a389a701d95bb721df60053bf6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adebb2a389a701d95bb721df60053bf6c">&#9670;&nbsp;</a></span>clearInterrupt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearInterrupt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe461d27b9c48d5921c00d521181f12f">&#9670;&nbsp;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main loop, implements the state machine. Will check for each stepper's state and do the appropriate polling (run() etc.) as needed. Also checks for incoming commands and passes them on for processing. </p>

</div>
</div>
<a id="a4906408a38ad9d4f1bca763aa75422ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4906408a38ad9d4f1bca763aa75422ad">&#9670;&nbsp;</a></span>processMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processMessage </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process message received via I2C. Normal messages consist of at least three bytes: [0] CRC8 checksum [1] Command. Most commands correspond to an AccelStepper function, some are new for I2C reasons (see I2C_commands.h). Unknown commands are ignored. [2] Number of the stepper that is to receive the command. If no stepper with this number exists, the message is ignored, except for general commands like resetCmd, which ignore this parameter. [3 - maxBuffer] Optional parameter bytes. Each command that comes with too many or too few parameter bytes is ignored. </p>
<dl class="section note"><dt>Note</dt><dd>Blocking functions <a class="el" href="_accel_stepper_i2_c_8h.html#a170d54f56d535f30b6cb09321e89c754">runToPositionCmd()</a> and <a class="el" href="_accel_stepper_i2_c_8h.html#ab6da5e42caa09167ae7c403ab66d53b8">runToNewPositionCmd()</a> not implemented here. Blocking at the slave's side seems not too useful, as the master won't wait for us anyway, </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Implement blocking functions <a class="el" href="_accel_stepper_i2_c_8h.html#a170d54f56d535f30b6cb09321e89c754">runToPositionCmd()</a> and <a class="el" href="_accel_stepper_i2_c_8h.html#ab6da5e42caa09167ae7c403ab66d53b8">runToNewPositionCmd()</a> on the master's side/in the library? </dd></dl>

</div>
</div>
<a id="a99e3313868c67fbcdc7a267c53ad4339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99e3313868c67fbcdc7a267c53ad4339">&#9670;&nbsp;</a></span>readEndstops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t readEndstops </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a52aa0319b0d3bea95eff4528baee98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a52aa0319b0d3bea95eff4528baee98">&#9670;&nbsp;</a></span>receiveEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void receiveEvent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>howMany</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle I2C receive event. Just read the message and inform main loop. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd><del>Just read the buffer here, move interpretation out of the interrupt.</del> </dd></dl>

</div>
</div>
<a id="ac10b80b8aaeaf66cecbf0bb5eff5ae33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac10b80b8aaeaf66cecbf0bb5eff5ae33">&#9670;&nbsp;</a></span>requestEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void requestEvent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle I2C request event. Will send results or information requested by the last command, as defined by the contents of the outputBuffer. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Find sth. meaningful to report from <a class="el" href="firmware_8ino.html#ac10b80b8aaeaf66cecbf0bb5eff5ae33" title="Handle I2C request event. Will send results or information requested by the last command,...">requestEvent()</a> if no message is pending, e.g. current position etc. </dd></dl>

</div>
</div>
<a id="a9d641c48e9eaae758eb0ea69cdbfa9c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d641c48e9eaae758eb0ea69cdbfa9c7">&#9670;&nbsp;</a></span>retrieveI2C_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t retrieveI2C_address </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a stored I2C address from EEPROM. If there is none, use default. </p>

</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&nbsp;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>setup system </p>

</div>
</div>
<a id="a04dab60aa1102ee6bfabfc6a039849ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04dab60aa1102ee6bfabfc6a039849ee">&#9670;&nbsp;</a></span>storeI2C_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void storeI2C_address </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>newAddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write I2C address to EEPROM. </p>

</div>
</div>
<a id="a50179c999500e0f9408006422deae52f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50179c999500e0f9408006422deae52f">&#9670;&nbsp;</a></span>triggerInterrupt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void triggerInterrupt </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9eca28b463b5850006c7d00aa43a2498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9eca28b463b5850006c7d00aa43a2498">&#9670;&nbsp;</a></span>bufferIn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_simple_buffer.html">SimpleBuffer</a>* bufferIn</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4d39df1bc00243ef2abb1ad3cc1acf8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d39df1bc00243ef2abb1ad3cc1acf8e">&#9670;&nbsp;</a></span>bufferOut</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_simple_buffer.html">SimpleBuffer</a>* bufferOut</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e30077c912bea300765cce6e5348b2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e30077c912bea300765cce6e5348b2d">&#9670;&nbsp;</a></span>currentDiagnostics</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdiagnostics_report.html">diagnosticsReport</a> currentDiagnostics</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af9405df89f8c78a1f50085b10911ca37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9405df89f8c78a1f50085b10911ca37">&#9670;&nbsp;</a></span>cycles</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t cycles = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a31bf94b26fef450b158d5840aa419886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31bf94b26fef450b158d5840aa419886">&#9670;&nbsp;</a></span>diagnosticsEnabled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool diagnosticsEnabled = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a404cd08737b3728198d3e42c828ece79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404cd08737b3728198d3e42c828ece79">&#9670;&nbsp;</a></span>eepromI2CaddressMarker</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t eepromI2CaddressMarker = 0x12C0ACCF</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af15a5efb5c2c5ce3714d8a2f6c309033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15a5efb5c2c5ce3714d8a2f6c309033">&#9670;&nbsp;</a></span>I2C_defaultAddress</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t I2C_defaultAddress = 0x8</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab1764b48f3cc3657deeb69208ad55cb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1764b48f3cc3657deeb69208ad55cb1">&#9670;&nbsp;</a></span>interruptActiveHigh</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool interruptActiveHigh = true</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a89786b8678479bcf2338a522d43b9381"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89786b8678479bcf2338a522d43b9381">&#9670;&nbsp;</a></span>interruptPin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t interruptPin = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa84ea5f47409c6c60bc911ba4bc06fb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa84ea5f47409c6c60bc911ba4bc06fb0">&#9670;&nbsp;</a></span>maxEndstops</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t maxEndstops = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4b5902c36f57eccdc4e911f63edcd14b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b5902c36f57eccdc4e911f63edcd14b">&#9670;&nbsp;</a></span>maxSteppers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t maxSteppers = 8</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="affd9824af02dde7126d00d43a74c0081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affd9824af02dde7126d00d43a74c0081">&#9670;&nbsp;</a></span>newMessage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t newMessage = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9ffc376a015a72bacc0fa343e6fd7dd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ffc376a015a72bacc0fa343e6fd7dd5">&#9670;&nbsp;</a></span>numSteppers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t numSteppers = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af470ac2a95380c26878282f7ddf529de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af470ac2a95380c26878282f7ddf529de">&#9670;&nbsp;</a></span>resetFunc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* resetFunc) (void)=0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7658032e03469b7a54542145f6d59bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7658032e03469b7a54542145f6d59bc6">&#9670;&nbsp;</a></span>steppers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_stepper.html">Stepper</a> steppers[<a class="el" href="_speed__diagnostics_8ino.html#ab21cefe8676da0e84f405d867c7e0cac">maxSteppers</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab0733c667851852a49c093ba87c7d77a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0733c667851852a49c093ba87c7d77a">&#9670;&nbsp;</a></span>thenMicros</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t thenMicros</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d9edf6c004b4a7ff14fe9ae7a92214ee.html">firmware</a></li><li class="navelem"><a class="el" href="firmware_8ino.html">firmware.ino</a></li>
    <li class="footer">Generated on Thu Feb 3 2022 00:34:29 for AccelStepperI2C by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
